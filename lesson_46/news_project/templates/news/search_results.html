{% extends "news/base.html" %}

{% block content %}
<div class="container-fluid my-5">

    <!-- ğŸ” Qidiruv formasi -->
    <div class="row mb-4">
        <div class="col-md-8 col-md-offset-2">
            <form method="get" action="{% url 'news:search' %}" class="input-group">
                <input type="text" name="q" value="{{ query }}" class="form-control" placeholder="Qidiruv...">
                <span class="input-group-btn">
                    <button class="btn btn-primary search-btn" type="submit">Qidirish</button>
                </span>
            </form>

        </div>
    </div>

    <!-- ğŸ“Œ Qidiruv natijalari sarlavhasi -->
    <h3 class="mb-4">
        Qidiruv natijalari{% if query %}: "{{ query }}"{% endif %}
    </h3>

    {% if results %}
        <div class="row">
            {% for item in results %}
                <div class="col-md-6 mb-4">
                    <div class="panel panel-default">
                        
                        <!-- ğŸ–¼ Yangilik rasmi -->
                        {% if item.image %}
                            <div style="height: 300px; overflow: hidden;">
                                <img src="{{ item.image.url }}" 
                                    alt="{{ item.title }}" 
                                    class="img-responsive" 
                                    style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                        {% endif %}

                        <!-- ğŸ“„ Kontent -->
                        <div class="panel-body">
                            <h4>
                                <a href="{{ item.get_absolute_url }}" class="text-decoration-none">
                                    {{ item.title }}
                                </a>
                            </h4>
                            <p class="text-muted">{{ item.content|truncatechars:120 }}</p>
                        </div>

                        <!-- ğŸ“… Sana, ğŸ‘¤ Muallif va ğŸ· Kategoriya -->
                        <div class="panel-footer small text-muted">
                            <span><i class="fa fa-user"></i> {{ item.author }}</span> | 
                            <span><i class="fa fa-calendar"></i> {{ item.published_at|date:"d M Y" }}</span> | 
                            <span><i class="fa fa-tag"></i> {{ item.category.name }}</span>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

        <!-- ğŸ“„ Pagination -->
        {% if results.has_other_pages %}
        <nav aria-label="Page navigation" class="text-center">
            <ul class="pagination">
                {% if results.has_previous %}
                <li><a href="?q={{ query }}&page={{ results.previous_page_number }}">Â« Oldingi</a></li>
                {% endif %}

                {% for num in results.paginator.page_range %}
                    {% if results.number == num %}
                        <li class="active"><span>{{ num }}</span></li>
                    {% elif num > results.number|add:-2 and num < results.number|add:2 %}
                        <li><a href="?q={{ query }}&page={{ num }}">{{ num }}</a></li>
                    {% endif %}
                {% endfor %}

                {% if results.has_next %}
                <li><a href="?q={{ query }}&page={{ results.next_page_number }}">Keyingi Â»</a></li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}

    {% else %}
        <div class="alert alert-warning text-center mt-4" role="alert">
            âŒ Hech narsa topilmadi.
        </div>
    {% endif %}

</div>
{% endblock %}
